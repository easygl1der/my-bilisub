# è§†é¢‘è½¬å½•å·¥å…· - å®Œæ•´ä½¿ç”¨æŒ‡å—

## ğŸ“‹ ç›®å½•
- [å¿«é€Ÿå¼€å§‹](#å¿«é€Ÿå¼€å§‹)
- [å·¥å…·ä»‹ç»](#å·¥å…·ä»‹ç»)
- [è¯¦ç»†ä½¿ç”¨æ–¹æ³•](#è¯¦ç»†ä½¿ç”¨æ–¹æ³•)
- [æ€§èƒ½å¯¹æ¯”](#æ€§èƒ½å¯¹æ¯”)
- [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)
- [æ–‡ä»¶è¯´æ˜](#æ–‡ä»¶è¯´æ˜)

---

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–
```bash
# æ ¸å¿ƒä¾èµ–
pip install yt-dlp openai-whisper

# FFmpegï¼ˆå¿…éœ€ï¼‰
# Windows: ä¸‹è½½ ffmpeg.exe å¹¶æ·»åŠ åˆ° PATH
# æˆ–: conda install ffmpeg -c conda-forge
```

### åŸºæœ¬ä½¿ç”¨

```bash
# æ¨èæ–¹å¼ï¼šä½¿ç”¨ç»ˆæå·¥å…·ï¼ˆæ•´åˆæ‰€æœ‰åŠŸèƒ½ï¼‰
python ultimate_transcribe.py -u "è§†é¢‘é“¾æ¥"

# å¯¹æ¯”æµ‹è¯•ï¼ˆOCR vs Whisperï¼‰
python ultimate_transcribe.py -u "è§†é¢‘é“¾æ¥" --compare

# ä½¿ç”¨ä¸åŒæ¨¡å‹
python ultimate_transcribe.py -u "è§†é¢‘é“¾æ¥" --model medium

# ç¦ç”¨OCRï¼ˆä»…Whisperï¼‰
python ultimate_transcribe.py -u "è§†é¢‘é“¾æ¥" --no-ocr
```

---

## ğŸ› ï¸ å·¥å…·ä»‹ç»

### æ¨èå·¥å…·

| å·¥å…· | åŠŸèƒ½ | çŠ¶æ€ | æ¨èåº¦ |
|------|------|------|--------|
| **ultimate_transcribe.py** | ç»Ÿä¸€å·¥å…·ï¼Œæ•´åˆæ‰€æœ‰æ–¹æ¡ˆ | âœ… å®Œç¾ | â­â­â­â­â­ |
| streaming_transcribe_v2.py | æµå¼ä¸‹è½½+Whisper | âœ… ç¨³å®š | â­â­â­â­ |
| check_subtitle.py | å­—å¹•æ£€æŸ¥å·¥å…· | âœ… å¯ç”¨ | â­â­â­ |

### å·²åºŸå¼ƒ

| å·¥å…· | åŸå›  |
|------|------|
| xiaohongshu_transcribe.py | åŠŸèƒ½å·²æ•´åˆåˆ° ultimate |
| streaming_transcribe.py | V2ç‰ˆæœ¬æ›´ä¼˜ |
| smart_transcribe.py | æœ‰å´©æºƒé—®é¢˜ï¼Œå·²ä¿®å¤ä¸º ultimate |
| smart_transcribe_fixed.py | åŠŸèƒ½å·²æ•´åˆåˆ° ultimate |

---

## ğŸ“– è¯¦ç»†ä½¿ç”¨æ–¹æ³•

### 1. ç»ˆæå·¥å…·ï¼ˆæ¨èï¼‰

**åŠŸèƒ½ï¼š**
- âœ… è‡ªåŠ¨æ£€æµ‹Bç«™/å°çº¢ä¹¦
- âœ… æ£€æŸ¥å†…ç½®å­—å¹•ï¼ˆæœ€å¿«ï¼‰
- âœ… è§†é¢‘OCRè¯†åˆ«ï¼ˆä¸­ç­‰é€Ÿåº¦ï¼‰
- âœ… Whisperè¯­éŸ³è½¬å½•ï¼ˆæœ€å‡†ç¡®ï¼‰
- âœ… è¯¦ç»†æ—¶é—´ç»Ÿè®¡

**ä½¿ç”¨æ–¹æ³•ï¼š**

```bash
# åŸºç¡€ç”¨æ³•
python ultimate_transcribe.py -u "è§†é¢‘é“¾æ¥"

# å®Œæ•´å¯¹æ¯”ï¼ˆæµ‹è¯•æ‰€æœ‰æ–¹æ¡ˆå¹¶è®¡æ—¶ï¼‰
python ultimate_transcribe.py -u "è§†é¢‘é“¾æ¥" --compare

# åˆ‡æ¢æ¨¡å‹
python ultimate_transcribe.py -u "è§†é¢‘é“¾æ¥" --model small   # å¿«é€Ÿ
python ultimate_transcribe.py -u "è§†é¢‘é“¾æ¥" --model medium  # å¹³è¡¡
python ultimate_transcribe.py -u "è§†é¢‘é“¾æ¥" --model large   # ç²¾å‡†

# ä»…ä½¿ç”¨Whisperï¼ˆè·³è¿‡OCRï¼‰
python ultimate_transcribe.py -u "è§†é¢‘é“¾æ¥" --no-ocr
```

**è¾“å‡ºç¤ºä¾‹ï¼š**
```
======================================================================
ğŸ¬ ç»ˆæè§†é¢‘è½¬å½•å·¥å…·
======================================================================
ğŸ” å¹³å°: BILIBILI
ğŸ”— é“¾æ¥: https://www.bilibili.com/video/BV1xx...
ğŸ“Œ Whisperæ¨¡å‹: small
ğŸ¤– OCR: å¯ç”¨

======================================================================
ğŸ” æ–¹æ¡ˆ 1/3: æ£€æŸ¥å†…ç½®å­—å¹•
======================================================================
â±ï¸  æ£€æŸ¥è€—æ—¶: 6.60ç§’
âŒ æ— å¯ç”¨å­—å¹•

======================================================================
ğŸ” æ–¹æ¡ˆ 2/3: è§†é¢‘OCRè¯†åˆ«
======================================================================
â¬‡ï¸  ä¸‹è½½è§†é¢‘...
âœ… ä¸‹è½½å®Œæˆ: 15.32ç§’
ğŸ” å¼€å§‹OCRè¯†åˆ«...
âœ… OCRå®Œæˆ!
â±ï¸  OCRè€—æ—¶: 45.20ç§’
â±ï¸  æ€»è€—æ—¶: 60.52ç§’
ğŸ“Š è¯†åˆ«åˆ° 25 è¡Œæ–‡å­—

âœ… ä½¿ç”¨æ–¹æ¡ˆ: è§†é¢‘OCR

ğŸ“ è¾“å‡ºæ–‡ä»¶:
   ğŸ“„ [OCR]_è§†é¢‘æ ‡é¢˜.txt
   ğŸ“Š [OCR]_è§†é¢‘æ ‡é¢˜.json
```

### 2. æµå¼è½¬å½•å·¥å…·

**ç‰¹ç‚¹ï¼š**
- å¿«é€Ÿä¸‹è½½éŸ³é¢‘
- Whisperè¯†åˆ«
- è¯¦ç»†æ—¶é—´ç»Ÿè®¡

```bash
python streaming_transcribe_v2.py -u "è§†é¢‘é“¾æ¥"
```

### 3. å­—å¹•æ£€æŸ¥å·¥å…·

**åŠŸèƒ½ï¼š** æ£€æŸ¥è§†é¢‘æ˜¯å¦æœ‰å†…ç½®å­—å¹•

```bash
# æ£€æŸ¥å•ä¸ªè§†é¢‘
python check_subtitle.py -u "è§†é¢‘é“¾æ¥"

# æ‰¹é‡æ£€æŸ¥
python check_subtitle.py -f "links.txt" --save
```

---

## âš¡ æ€§èƒ½å¯¹æ¯”

### Whisperæ¨¡å‹å¯¹æ¯”

| æ¨¡å‹ | å¤§å° | é€Ÿåº¦ | ç²¾åº¦ | 2åˆ†é’Ÿè§†é¢‘è€—æ—¶ |
|------|------|------|------|--------------|
| tiny | 39M | æœ€å¿« | ä½ | ~30ç§’ |
| base | 74M | å¿« | ä¸­ | ~45ç§’ |
| **small** | **244M** | **ä¸­ç­‰** | **é«˜** | **~75ç§’** âœ… |
| medium | 769M | æ…¢ | å¾ˆé«˜ | ~180ç§’ |
| large | 1.5G | æœ€æ…¢ | æœ€é«˜ | ~300ç§’ |

**æ¨èï¼š** ä½¿ç”¨ `small` æ¨¡å‹ï¼Œé€Ÿåº¦å’Œç²¾åº¦å¹³è¡¡æœ€ä½³

### æ–¹æ¡ˆå¯¹æ¯”

| æ–¹æ¡ˆ | è€—æ—¶ | é€‚ç”¨åœºæ™¯ |
|------|------|---------|
| å†…ç½®å­—å¹• | <10ç§’ | æœ‰å®˜æ–¹å­—å¹•çš„è§†é¢‘ |
| è§†é¢‘OCR | 1-2åˆ†é’Ÿ | æœ‰å¤§é‡å­—å¹•çš„è§†é¢‘ |
| Whisperè¯­éŸ³ | 1-3åˆ†é’Ÿ | æ— å­—å¹•ï¼Œä¾èµ–è¯­éŸ³ |

### å®æµ‹æ•°æ®ï¼ˆ2åˆ†é’ŸBç«™è§†é¢‘ï¼‰

```
æ£€æŸ¥å†…ç½®å­—å¹•: 6.60ç§’
ä¸‹è½½éŸ³é¢‘: 11.21ç§’
Whisperè¯†åˆ«: 62.36ç§’
æ€»è®¡: 77.57ç§’
é€Ÿåº¦æ¯”: 1.54x å®æ—¶
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: ç¨‹åºå´©æºƒï¼ˆSegmentation faultï¼‰
**A:** ä½¿ç”¨ `small` æ¨¡å‹ä»£æ›¿ `medium`ï¼š
```bash
python ultimate_transcribe.py -u "é“¾æ¥" --model small
```

### Q2: ä¸‹è½½é€Ÿåº¦æ…¢
**A:** å·¥å…·å·²ä¼˜åŒ–å¹¶å‘ä¸‹è½½ã€‚å¦‚ä»æ…¢ï¼š
- æ£€æŸ¥ç½‘ç»œè¿æ¥
- å°è¯•ä½¿ç”¨ä»£ç†
- ä½¿ç”¨æµå¼å·¥å…·ï¼š`streaming_transcribe_v2.py`

### Q3: å°çº¢ä¹¦è§†é¢‘ä¸‹è½½å¤±è´¥
**A:** å°çº¢ä¹¦æœ‰é˜²ç›—é“¾ï¼Œå¶å°”å‡ºç°502é”™è¯¯ã€‚é‡è¯•å³å¯ã€‚

### Q4: å¦‚ä½•æ‰¹é‡å¤„ç†ï¼Ÿ
**A:** åˆ›å»º `links.txt`ï¼ˆæ¯è¡Œä¸€ä¸ªé“¾æ¥ï¼‰ï¼š
```bash
# ä½¿ç”¨å‘½ä»¤è¡Œæ‰¹é‡å¤„ç†
for link in $(cat links.txt); do
    python ultimate_transcribe.py -u "$link"
done
```

### Q5: OCRè¯†åˆ«ä¸åˆ°æ–‡å­—
**A:** å¯èƒ½åŸå› ï¼š
- è§†é¢‘ä¸­ç¡®å®æ²¡æœ‰æ–‡å­—
- å­—å¹•å¤ªå°æˆ–æ¨¡ç³Š
- å°è¯•è°ƒæ•´OCRå‚æ•°

### Q6: å¦‚ä½•åªæå–éŸ³é¢‘ä¸è¯†åˆ«ï¼Ÿ
**A:** ä½¿ç”¨ yt-dlp ç›´æ¥ä¸‹è½½ï¼š
```bash
yt-dlp -x --audio-format mp3 "è§†é¢‘é“¾æ¥"
```

---

## ğŸ“ æ–‡ä»¶è¯´æ˜

### æ ¸å¿ƒæ–‡ä»¶ï¼ˆä¿ç•™ï¼‰

```
biliSub/
â”œâ”€â”€ ultimate_transcribe.py          # â­ ä¸»å·¥å…·
â”œâ”€â”€ streaming_transcribe_v2.py      # æµå¼å·¥å…·
â”œâ”€â”€ check_subtitle.py               # å­—å¹•æ£€æŸ¥
â”œâ”€â”€ ä½¿ç”¨æŒ‡å—.md                      # æœ¬æ–‡æ¡£
â”œâ”€â”€ PROJECT_SUMMARY.md              # æŠ€æœ¯æ–‡æ¡£
â””â”€â”€ output/
    â”œâ”€â”€ ultimate/                   # ç»ˆæå·¥å…·è¾“å‡º
    â”‚   â”œâ”€â”€ builtin/               # å†…ç½®å­—å¹•
    â”‚   â”œâ”€â”€ ocr/                   # OCRç»“æœ
    â”‚   â””â”€â”€ whisper/               # Whisperç»“æœ
    â””â”€â”€ transcripts/               # æµå¼å·¥å…·è¾“å‡º
```

### å¯åˆ é™¤ï¼ˆåŠŸèƒ½å·²æ•´åˆï¼‰

```
âŒ xiaohongshu_transcribe.py        # å·²æ•´åˆåˆ° ultimate
âŒ streaming_transcribe.py          # V2ç‰ˆæœ¬æ›´ä¼˜
âŒ smart_transcribe.py              # å´©æºƒï¼Œå·²ä¿®å¤
âŒ smart_transcribe_fixed.py        # å·²æ•´åˆåˆ° ultimate
âŒ test_xiaohongshu.py              # æµ‹è¯•æ–‡ä»¶
```

### è¾“å‡ºæ ¼å¼

æ¯ä¸ªå·¥å…·ç”Ÿæˆ3ç§æ ¼å¼ï¼š

| æ ¼å¼ | è¯´æ˜ | ç¤ºä¾‹ |
|------|------|------|
| `.txt` | çº¯æ–‡æœ¬ | ç›´æ¥å¤åˆ¶ä½¿ç”¨ |
| `.srt` | å­—å¹•æ–‡ä»¶ | è§†é¢‘æ’­æ”¾å™¨ |
| `.json` | å®Œæ•´æ•°æ® | ç¨‹åºå¤„ç† |

---

## ğŸ¯ ä½¿ç”¨åœºæ™¯

### åœºæ™¯1: å¿«é€Ÿè½¬å½•Bç«™è§†é¢‘

```bash
python ultimate_transcribe.py -u "Bç«™é“¾æ¥" --model small
```

**è€—æ—¶ï¼š** ~1-2åˆ†é’Ÿï¼ˆ2åˆ†é’Ÿè§†é¢‘ï¼‰

### åœºæ™¯2: æå–å°çº¢ä¹¦è§†é¢‘å­—å¹•

```bash
python ultimate_transcribe.py -u "å°çº¢ä¹¦é“¾æ¥"
```

**æ³¨æ„ï¼š** å°çº¢ä¹¦å¶å°”502é”™è¯¯ï¼Œé‡è¯•å³å¯

### åœºæ™¯3: å¯¹æ¯”OCR vs Whisper

```bash
python ultimate_transcribe.py -u "è§†é¢‘é“¾æ¥" --compare
```

**è¾“å‡ºï¼š**
- æ—¶é—´ç»Ÿè®¡å¯¹æ¯”
- å‡†ç¡®åº¦å»ºè®®
- é€Ÿåº¦å¯¹æ¯”

### åœºæ™¯4: æ‰¹é‡å¤„ç†

```bash
# åˆ›å»º links.txt
cat > links.txt << EOF
https://www.bilibili.com/video/BV1xx...
https://www.xiaohongshu.com/explore/...
EOF

# æ‰¹é‡å¤„ç†
python ultimate_transcribe.py -u "$(cat links.txt)"
```

---

## ğŸ”§ é«˜çº§é…ç½®

### ä¿®æ”¹æ¨¡å‹å¤§å°

ç¼–è¾‘ `ultimate_transcribe.py`ï¼š
```python
WHISPER_MODEL = "small"  # æ”¹ä¸º medium/large
```

### ä¿®æ”¹è¾“å‡ºç›®å½•

```python
OUTPUT_DIR = Path("output/my_folder")
```

### æ·»åŠ ä»£ç†

```python
ydl_opts = {
    'proxy': 'http://127.0.0.1:7890',
    ...
}
```

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–å»ºè®®

### 1. é€‰æ‹©åˆé€‚çš„æ¨¡å‹
- **å¿«é€Ÿå¤„ç†**: `small`ï¼ˆæ¨èï¼‰
- **é«˜è´¨é‡**: `medium`ï¼ˆæ—¶é—´å……è£•ï¼‰
- **æœ€å¿«**: `tiny`ï¼ˆæµ‹è¯•ç”¨ï¼‰

### 2. å¹¶å‘ä¸‹è½½
å·¥å…·å·²ä¼˜åŒ–ï¼š
```python
'concurrentfragments': 4,  # 4å¹¶å‘è¿æ¥
```

### 3. ç¡¬ä»¶åŠ é€Ÿ
- GPUï¼šå¯ä½¿ç”¨GPUç‰ˆæœ¬çš„Whisperï¼ˆéœ€CUDAï¼‰
- å¤šæ ¸ï¼šè‡ªåŠ¨ä½¿ç”¨å¤šæ ¸å¤„ç†

---

## ğŸ†˜ æŠ€æœ¯æ”¯æŒ

### æ£€æŸ¥ç¯å¢ƒ
```bash
# æ£€æŸ¥ä¾èµ–
python -c "import whisper; import yt_dlp; print('âœ“ ç¯å¢ƒæ­£å¸¸')"

# æ£€æŸ¥FFmpeg
ffmpeg -version

# æ£€æŸ¥æ¨¡å‹
python -c "import whisper; whisper.load_model('small'); print('âœ“ æ¨¡å‹å¯ç”¨')"
```

### è°ƒè¯•æ¨¡å¼
```bash
# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
python ultimate_transcribe.py -u "é“¾æ¥" --verbose
```

---

## ğŸ“ æ›´æ–°æ—¥å¿—

### v1.0 (2026-02-15)
- âœ… åˆ›å»ºç»ˆææ•´åˆå·¥å…·
- âœ… æ·»åŠ æ—¶é—´ç»Ÿè®¡åŠŸèƒ½
- âœ… ä¿®å¤Whisperå´©æºƒé—®é¢˜
- âœ… æ”¯æŒBç«™/å°çº¢ä¹¦
- âœ… é›†æˆVideOCRåŠŸèƒ½

---

## ğŸ“ ç¤ºä¾‹

### ç¤ºä¾‹1: Bç«™è§†é¢‘è½¬å½•

```bash
$ python ultimate_transcribe.py -u "https://www.bilibili.com/video/BV1fkzpB8EqD"

======================================================================
ğŸ¬ ç»ˆæè§†é¢‘è½¬å½•å·¥å…·
======================================================================
ğŸ” å¹³å°: BILIBILI
ğŸ“Œ Whisperæ¨¡å‹: small

======================================================================
ğŸ” æ–¹æ¡ˆ 1/3: æ£€æŸ¥å†…ç½®å­—å¹•
======================================================================
â±ï¸  æ£€æŸ¥è€—æ—¶: 6.60ç§’
âŒ æ— å¯ç”¨å­—å¹•

======================================================================
ğŸ” æ–¹æ¡ˆ 3/3: Whisperè¯­éŸ³è½¬å½•
======================================================================
â¬‡ï¸  ä¸‹è½½éŸ³é¢‘... 11.21ç§’
ğŸ™ï¸  Whisperè¯†åˆ«ä¸­... 62.36ç§’
âœ… è¯†åˆ«å®Œæˆ!
â±ï¸  æ€»è€—æ—¶: 77.57ç§’
ğŸ“Š é€Ÿåº¦æ¯”: 1.54x å®æ—¶

ğŸ“ è¾“å‡º:
   ğŸ“„ [WHISPER]_è§†é¢‘æ ‡é¢˜.txt
   ğŸ“Š [WHISPER]_è§†é¢‘æ ‡é¢˜.json
```

---

**æœ€åæ›´æ–°ï¼š** 2026-02-15
**é¡¹ç›®çŠ¶æ€ï¼š** âœ… ç¨³å®šå¯ç”¨
**æ¨èå·¥å…·ï¼š** `ultimate_transcribe.py`
