# 图片描述功能说明

## 🎯 新功能

AI 会为每张图片生成场景描述，并显示在图片下方！

## 📝 生成的效果

```markdown
## 🖼️ 笔记图片

### 图片 1

![笔记标题 - 图片1](https://cdn.jsdelivr.net/gh/.../image_001.jpg)

**📝 场景描述**: 城市夜景，夜晚的街道，有路灯和建筑，显得有些繁华和热闹。

### 图片 2

![笔记标题 - 图片2](https://cdn.jsdelivr.net/gh/.../image_002.jpg)

**📝 场景描述**: 室内场所，看起来像是一个有装饰的活动现场，有酒杯和盛装打扮的人。

...
```

## 🔄 工作流程

1. **下载图片** - 从小红书下载笔记图片
2. **上传到 Gemini** - 将图片上传到 AI 服务
3. **生成描述** - AI 分析每张图片并生成场景描述
4. **综合分析** - AI 分析所有图片和文案，生成完整报告
5. **保存 Markdown** - 将图片、描述和分析结果保存到 Markdown

## 📦 图片描述包含的内容

每张图片的描述会包含：

1. **场景环境** - 图片拍摄的地点（室内/室外、具体场所）
2. **主要元素** - 图片中的主要人物、物品或建筑
3. **色彩与光线** - 图片的色彩风格和光线特点
4. **氛围感受** - 图片传达的整体氛围或情感

## ⏱️ 处理时间

- **图片数量**: 10 张
- **图片描述**: 约 30-40 秒（每张 3-4 秒）
- **综合分析**: 约 20-30 秒
- **总计**: 约 1-2 分钟

## 💰 成本

使用 Gemini flash-lite 模型：
- 图片描述: 每张约 100-200 tokens
- 综合分析: 约 1000-2000 tokens
- 总计: 约 2000-4000 tokens 每篇笔记

**参考**: Gemini flash-lite 免费 15 RPM/1000 RPD

## 🎨 示例输出

### 输入
一张城市夜景图片

### AI 描述
```
城市夜景，夜晚的街道，有路灯和建筑。街道两侧灯火通明，建筑物在夜色中显得格外繁华和热闹。整体氛围是都市的夜晚，充满了活力和生活气息。
```

## 📊 与视频分析的区别

| 特性 | 视频分析 | 小红书图文分析 |
|------|---------|---------------|
| **分析对象** | 视频关键帧 | 所有图片 |
| **描述位置** | 在 AI 分析报告中 | 在图片下方 |
| **描述方式** | 提取关键帧后分析 | 每张图单独分析 |
| **详细程度** | 选择性描述 | 全部图片都有描述 |

## ⚙️ 如何使用

### 自动生成（默认）

```bash
python analysis/xhs_image_analysis.py --url "小红书链接"
```

图片描述会自动生成并添加到 Markdown 中。

### 本地文件夹分析

```bash
python analysis/xhs_image_analysis.py --dir "xhs_images/用户名/笔记标题"
```

同样会自动生成图片描述。

## 🎁 完整示例

生成的 Markdown 结构：

```markdown
# 笔记标题

## 📌 元信息
...

---

## 🖼️ 笔记图片

### 图片 1
![图片1](...)
**📝 场景描述**: 城市夜景，夜晚的街道...

### 图片 2
![图片2](...)
**📝 场景描述**: 室内场所，有装饰和活动...

### 图片 3
![图片3](...)
**📝 场景描述**: 涂鸦墙前，色彩鲜艳...

---

## 📄 原始文字内容
...

---

## 🤖 AI 分析结果

### 场景描述

**整体场景**:
- **环境**: 第一张图为城市夜景...
- **时间**: 整体氛围偏向...
- **氛围**: 轻松、愉快...

...
```

## 🔧 自定义描述提示词

如果需要修改图片描述的提示词，编辑 `analysis/xhs_image_analysis.py` 中的 `analyze_single_image` 方法：

```python
prompt = """请详细描述这张图片的内容，包括：
1. 场景环境
2. 主要元素
3. 色彩与光线
4. 氛围感受

请用简洁清晰的语言描述，2-3句话即可。"""
```

## 💡 提示

1. **图片质量**: 图片质量越高，描述越准确
2. **图片数量**: 图片越多，处理时间越长
3. **网络速度**: 需要稳定的网络连接上传图片
4. **API 限制**: 注意 Gemini API 的速率限制

## 🚀 现在就试试

```bash
python analysis/xhs_image_analysis.py --url "小红书链接" --upload-github
```

生成的 Markdown 会包含：
- ✅ 图片（使用 CDN 链接）
- ✅ 每张图片的场景描述
- ✅ 完整的 AI 分析报告
- ✅ 笔记链接和用户主页
